import{d as Dt,t as dt,a as ft}from"../chunks/u0wEViTw.js";import{h as Y,x as At,E as Gt,aE as Jt,aF as Vt,am as Wt,M as Ht,aG as Kt,aH as Qt,an as Ut,n as z,T as Nt,V as Et,W as Xt,O as Yt,au as Zt,ab as h,aB as T,s as d,Q as m,S as vt,g as a,P as te,aI as St,aD as k,R as p}from"../chunks/CG7uwIZo.js";import{a as ee,s as Tt}from"../chunks/6owECmvk.js";import{i as ae}from"../chunks/DwhbRjO_.js";import{e as ie,i as re}from"../chunks/DrLgCjVk.js";import{s as K,b as D,r as Ft}from"../chunks/1YAlPjso.js";import{w as se,b as Ct}from"../chunks/o9oSExv4.js";import{o as ne}from"../chunks/C4AfcEsr.js";import{b as Q}from"../chunks/D-Dpn1z5.js";function Ot(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(t=0;t<l;t++)e[t]&&(r=Ot(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function oe(){for(var e,t,r=0,s="",l=arguments.length;r<l;r++)(e=arguments[r])&&(t=Ot(e))&&(s&&(s+=" "),s+=t);return s}function It(e){return typeof e=="object"?oe(e):e??""}function le(e,t,r){var s=e==null?"":""+e;return t&&(s=s?s+" "+t:t),s===""?null:s}function ce(e,t){return e==null?null:String(e)}function R(e,t,r,s,l,v){var o=e.__className;if(Y||o!==r||o===void 0){var _=le(r,s);(!Y||_!==e.getAttribute("class"))&&(_==null?e.removeAttribute("class"):e.className=_),e.__className=r}return v}function U(e,t,r,s){var l=e.__style;if(Y||l!==t){var v=ce(t);(!Y||v!==e.getAttribute("style"))&&(v==null?e.removeAttribute("style"):e.style.cssText=v),e.__style=t}return s}const ue=()=>performance.now(),w={tick:e=>requestAnimationFrame(e),now:()=>ue(),tasks:new Set};function jt(){const e=w.now();w.tasks.forEach(t=>{t.c(e)||(w.tasks.delete(t),t.f())}),w.tasks.size!==0&&w.tick(jt)}function fe(e){let t;return w.tasks.size===0&&w.tick(jt),{promise:new Promise(r=>{w.tasks.add(t={c:e,f:r})}),abort(){w.tasks.delete(t)}}}function X(e,t){se(()=>{e.dispatchEvent(new CustomEvent(t))})}function ve(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function Rt(e){const t={},r=e.split(";");for(const s of r){const[l,v]=s.split(":");if(!l||v===void 0)break;const o=ve(l.trim());t[o]=v.trim()}return t}const pe=e=>e;function de(e,t,r,s){var l=(e&Kt)!==0,v="both",o,_=t.inert,u=t.style.overflow,c,n;function x(){var f=Xt,A=At;Nt(null),Et(null);try{return o??(o=r()(t,(s==null?void 0:s())??{},{direction:v}))}finally{Nt(f),Et(A)}}var $={is_global:l,in(){t.inert=_,X(t,"introstart"),c=pt(t,x(),n,1,()=>{X(t,"introend"),c==null||c.abort(),c=o=void 0,t.style.overflow=u})},out(f){t.inert=!0,X(t,"outrostart"),n=pt(t,x(),c,0,()=>{X(t,"outroend"),f==null||f()})},stop:()=>{c==null||c.abort(),n==null||n.abort()}},g=At;if((g.transitions??(g.transitions=[])).push($),ee){var y=l;if(!y){for(var i=g.parent;i&&(i.f&Gt)!==0;)for(;(i=i.parent)&&(i.f&Jt)===0;);y=!i||(i.f&Vt)!==0}y&&Wt(()=>{Ht(()=>$.in())})}}function pt(e,t,r,s,l){var v=s===1;if(Qt(t)){var o,_=!1;return Ut(()=>{if(!_){var f=t({direction:v?"in":"out"});o=pt(e,f,r,s,l)}}),{abort:()=>{_=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(r==null||r.deactivate(),!(t!=null&&t.duration))return l(),{abort:z,deactivate:z,reset:z,t:()=>s};const{delay:u=0,css:c,tick:n,easing:x=pe}=t;var $=[];if(v&&r===void 0&&(n&&n(0,1),c)){var g=Rt(c(0,1));$.push(g,g)}var y=()=>1-s,i=e.animate($,{duration:u});return i.onfinish=()=>{var f=(r==null?void 0:r.t())??1-s;r==null||r.abort();var A=s-f,L=t.duration*Math.abs(A),F=[];if(L>0){var N=!1;if(c)for(var O=Math.ceil(L/16.666666666666668),C=0;C<=O;C+=1){var G=f+A*x(C/O),I=Rt(c(G,1-G));F.push(I),N||(N=I.overflow==="hidden")}N&&(e.style.overflow="hidden"),y=()=>{var E=i.currentTime;return f+A*x(E/L)},n&&fe(()=>{if(i.playState!=="running")return!1;var E=y();return n(E,1-E),!0})}i=e.animate(F,{duration:L,fill:"forwards"}),i.onfinish=()=>{y=()=>s,n==null||n(s,1-s),l()}},{abort:()=>{i&&(i.cancel(),i.effect=null,i.onfinish=z)},deactivate:()=>{l=z},reset:()=>{s===0&&(n==null||n(1,0))},t:()=>y()}}function _e(e){const t=e-1;return t*t*t+1}function Lt(e){const t=typeof e=="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}function be(e,{delay:t=0,duration:r=400,easing:s=_e,x:l=0,y:v=0,opacity:o=0}={}){const _=getComputedStyle(e),u=+_.opacity,c=_.transform==="none"?"":_.transform,n=u*(1-o),[x,$]=Lt(l),[g,y]=Lt(v);return{delay:t,duration:r,easing:s,css:(i,f)=>`
			transform: ${c} translate(${(1-i)*x}${$}, ${(1-i)*g}${y});
			opacity: ${u-n*f}`}}function me(e,t,r){t(),d(r,!0)}var ye=dt('<li class="svelte-1nu4p3t"><a> </a></li>'),ge=dt('<div class="listener svelte-1nu4p3t"></div>'),he=(e,t)=>d(t,!a(t)),ke=(e,t)=>d(t,!a(t)),xe=dt('<div class="layout svelte-1nu4p3t"><div class="borad svelte-1nu4p3t"><nav class="svelte-1nu4p3t"><ul class="svelte-1nu4p3t"></ul></nav> <a class="slide svelte-1nu4p3t" aria-label="スライド"></a></div> <a class="sub-wrap svelte-1nu4p3t"><div aria-label="スライド"></div> <!> <div class="sub svelte-1nu4p3t"><p class="md:text-2xl lg:text-3xl svelte-1nu4p3t"> </p></div></a> <input type="range" min="0" class="progress svelte-1nu4p3t"> <div class="menu grid grid-cols-5 gap-0.5 svelte-1nu4p3t"><button aria-label="voice" class="svelte-1nu4p3t"><iconify-icon></iconify-icon></button> <button aria-label="auto-voice" class="svelte-1nu4p3t"><iconify-icon></iconify-icon></button> <button aria-label="play-voice" class="svelte-1nu4p3t"><iconify-icon></iconify-icon></button> <button aria-label="stop-voice" class="svelte-1nu4p3t"><iconify-icon></iconify-icon></button> <div class="speedometer flex items-center justify-center svelte-1nu4p3t"><iconify-icon></iconify-icon> <input type="range" min="0.5" max="2" step="0.1" class="w-[60%] accent-gray-300 svelte-1nu4p3t"></div></div></div>',2);function Ie(e,t){Yt(t,!0);let r=Zt(t.data.courseId);const{courseName:s,chapterId:l,chapterName:v,page:o}=t.data.scenario,_=k(()=>o.length);let u=T(0),c=k(()=>o[a(u)].subtitle.length),n=T(0),x=k(()=>o[a(u)].subtitle[a(n)].text),$=k(()=>{var b,S,B;return((B=(S=(b=o[a(u)])==null?void 0:b.subtitle)==null?void 0:S[a(n)])==null?void 0:B.color)||"black"}),g=k(()=>`${Q}/${r}/img/${o[a(u)].subtitle[a(n)].slide}`),y=k(()=>`${Q}/actor/${o[a(u)].subtitle[a(n)].actorImg}`),i=null,f=k(()=>o[a(u)].subtitle[a(n)].voice),A=k(()=>`${Q}/${r}/voice/${a(f)}`),L=k(()=>o[a(u)].subtitle[a(n)].anime),F=T(!1),N=T(!0),O=T(!1),C=k(()=>`${o[a(u)].subtitle[a(n)].listener}`),G=k(()=>`${Q}/actor/${a(C)}`),I=T(!0),E=T(!0),j=T(1),_t=1;ne(()=>(i=new Audio("/sounds/yo.mp3"),i.onerror=()=>{console.error(`音声ファイル "${a(A)}" の読み込みに失敗しました。`)},i.load(),i.playbackRate=Number(a(j)),()=>{i&&(i.pause(),i.removeAttribute("src"),i.load(),i=null)}));function Z(){if(a(N)&&a(f)&&a(I))tt();else{if(a(u)+1==a(_)&&a(n)+1==a(c)){a(O)||d(O,!0);return}a(n)+1==a(c)?(St(u),d(n,0)):St(n),a(I)&&tt()}d(N,!1)}function Mt(b){d(u,b,!0),d(n,0),et(),d(N,!0)}async function tt(){i&&i.pause(),a(f)&&(i=await new Audio(a(A)),i.playbackRate=Number(a(j)),i.volume=Number(_t),i.play(),d(F,!0),d(N,!1),i.addEventListener("ended",()=>{d(F,!1),a(E)&&Z()}))}function et(){i&&(i.pause(),d(F,!1))}function Pt(){i&&(i.pause(),i.playbackRate=Number(a(j)),i.volume=Number(_t),i.play())}var at=xe(),it=m(at),rt=m(it),bt=m(rt);ie(bt,21,()=>o,re,(b,S,B)=>{var ut=ye(),q=m(ut);K(q,"href",null),q.__click=()=>Mt(B);var zt=m(q,!0);p(q),p(ut),vt(()=>{R(q,1,`hover:bg-black/70 md:text-2xl ${B==a(u)?"bg-black/70":""}`,"svelte-1nu4p3t"),Tt(zt,a(S).title)}),ft(b,ut)}),p(bt),p(rt);var st=h(rt,2);K(st,"href",null),st.__click=Z,p(it);var M=h(it,2);K(M,"href",null),M.__click=Z;var nt=m(M),mt=h(nt,2);{var Bt=b=>{var S=ge();vt(()=>U(S,`background-image: url(${a(G)??""})`)),de(3,S,()=>be,()=>({x:100,duration:300})),ft(b,S)};ae(mt,b=>{a(C)&&b(Bt)})}var yt=h(mt,2),ot=m(yt),qt=m(ot,!0);p(ot),p(yt),p(M);var P=h(M,2);Ft(P),P.__change=[me,et,N];var gt=h(P,2),J=m(gt);J.__click=[he,I];var ht=m(J);D(ht,"icon","mdi:volume"),p(J);var V=h(J,2);V.__click=[ke,E];var kt=m(V);D(kt,"icon","mdi:loop"),p(V);var W=h(V,2);W.__click=tt;var xt=m(W);D(xt,"icon","mdi:play"),R(xt,1,"svelte-1nu4p3t"),p(W);var H=h(W,2);H.__click=et;var $t=m(H);D($t,"icon","mdi:stop"),R($t,1,"svelte-1nu4p3t"),p(H);var wt=h(H,2),lt=m(wt);D(lt,"icon","mdi:speedometer"),R(lt,1,"svelte-1nu4p3t");var ct=h(lt,2);Ft(ct),ct.__change=Pt,p(wt),p(gt),p(at),vt(()=>{U(st,`background-image: url(${a(g)??""})`),R(nt,1,`actor ${a(L)?"anime ":""} ${a(F)&&!a(C)?"talk":""}`,"svelte-1nu4p3t"),U(nt,`background-image: url(${a(y)??""})`),U(ot,`-webkit-text-stroke-color: ${a($)??""};`),Tt(qt,a(x)),K(P,"max",a(c)-1),R(ht,1,It(a(I)?"":"text-gray-600"),"svelte-1nu4p3t"),R(kt,1,It(a(E)?"":"text-gray-600"),"svelte-1nu4p3t")}),Ct(P,()=>a(n),b=>d(n,b)),Ct(ct,()=>a(j),b=>d(j,b)),ft(e,at),te()}Dt(["click","change"]);export{Ie as component};
